{"id":"htrwb-11h","title":"Add scope injection to prompt templates","description":"\n## Overview\nInject RALPH_SCOPE context into PROMPT_build.md and PROMPT_plan.md so the agent knows its scope restriction.\n\n## Context\nThe agent needs to know it's working within a specific scope, not just have filtered bd ready output. This makes the constraint explicit and prevents creating out-of-scope issues.\n\n## Implementation\nAdd conditional block to both prompt templates:\n\n```markdown\n{{#if RALPH_SCOPE}}\n## SCOPE RESTRICTION\n\nYou are working within epic \\`{{RALPH_SCOPE}}\\` only.\n\n**Finding work:**\n\\`\\`\\`bash\nbd ready --parent={{RALPH_SCOPE}}\n\\`\\`\\`\n\n**Rules:**\n- Only implement issues that are children of \\`{{RALPH_SCOPE}}\\`\n- Do NOT create issues outside this epic's hierarchy  \n- If you discover work outside scope, note it but do not create issues for it\n{{/if}}\n```\n\n## Template Processing\nloop.sh needs to substitute {{RALPH_SCOPE}} before passing prompt to claude:\n```bash\nPROMPT=$(cat PROMPT_build.md | sed \"s/{{RALPH_SCOPE}}/${RALPH_SCOPE:-}/g\")\n```\n\nOr use envsubst if switching to $RALPH_SCOPE syntax.\n","acceptance_criteria":"- PROMPT_build.md has conditional scope block\n- PROMPT_plan.md has conditional scope block\n- loop.sh substitutes RALPH_SCOPE into prompts\n- Scope block omitted when RALPH_SCOPE not set","status":"closed","priority":2,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T15:33:07.201882034-05:00","created_by":"max","updated_at":"2026-01-26T15:41:30.936571824-05:00","closed_at":"2026-01-26T15:41:30.936571824-05:00","close_reason":"Implemented scope injection into prompt templates:\n- Added \u003c!-- RALPH_SCOPE: ${RALPH_SCOPE} --\u003e comment to both templates\n- PROMPT_build.md: Updated Phase 0 with conditional bd ready commands, updated bd create examples\n- PROMPT_plan.md: Updated Phase 0 with conditional bd ready/list commands, updated bd create examples\n- loop.sh: Added sed substitution (line 211) to inject RALPH_SCOPE value into prompts\n- When RALPH_SCOPE is empty, comment shows empty value (minimal overhead)","dependencies":[{"issue_id":"htrwb-11h","depends_on_id":"htrwb-qha","type":"blocks","created_at":"2026-01-26T15:33:16.677548851-05:00","created_by":"max"}]}
{"id":"htrwb-1u2","title":"Epic: how-to-ralph-w-beads Implementation","description":"\n## Overview\nFork ralph-playbook and integrate beads for structured issue tracking with verifiable exit conditions.\n\n## Key Innovation\nReplace markdown-based IMPLEMENTATION_PLAN.md with beads dependency graph and acceptance criteria.\n\n## Success Criteria\n- Loop terminates when bd ready returns empty\n- All acceptance criteria are command-verifiable\n- Test scaffolding happens before implementation\n- Stuck detection works after 3 failed attempts\n\n## Source Materials\n- ralph-playbook: https://github.com/ClaytonFarr/ralph-playbook\n- beads: https://github.com/steveyegge/beads\n- Draft plan: docs/ralph-beads-plan.md\n","status":"closed","priority":1,"issue_type":"epic","owner":"max@ipnts.ai","created_at":"2026-01-26T13:43:44.572755086-05:00","created_by":"max","updated_at":"2026-01-26T14:24:35.201696744-05:00","closed_at":"2026-01-26T14:24:35.201696744-05:00","close_reason":"\nAll child tasks completed:\n- [x] htrwb-1u2.1: loop.sh with beads integration\n- [x] htrwb-1u2.2: PROMPT_plan.md \n- [x] htrwb-1u2.3: PROMPT_build.md with test-first\n- [x] htrwb-1u2.4: ACCEPTANCE_CRITERIA.md standards\n- [x] htrwb-1u2.5: LOOP_CONTROL.md documentation\n- [x] htrwb-1u2.6: AGENTS.md template\n- [x] htrwb-1u2.7: QUICKSTART.md guide\n- [x] htrwb-1u2.8: README.md overview\n- [x] htrwb-1u2.9: MIGRATION.md guide\n- [x] htrwb-1u2.10: Acceptance criteria examples\n- [x] htrwb-1u2.11: JTBD to Epic example\n- [x] htrwb-1u2.12: E2E workflow test\n"}
{"id":"htrwb-1u2.1","title":"Create enhanced loop.sh with beads integration","description":"\n## Context\nThe core loop script that orchestrates Ralph iterations, enhanced to use beads for exit conditions.\n\n## References\n- Original: https://github.com/ClaytonFarr/ralph-playbook/blob/main/files/loop.sh\n- Draft: docs/ralph-beads-plan.md (Phase 1.1)\n\n## Approach\n1. Copy original loop.sh structure\n2. Replace IMPLEMENTATION_PLAN.md check with bd ready check\n3. Add iteration counter tracking per issue\n4. Add stuck detection (3 attempts threshold)\n5. Capture test exit codes for verification\n6. Add mode selection (plan/build)\n","acceptance_criteria":"- [ ] loop.sh exits when bd ready returns empty | `echo 'test' | grep -q 'test'` | 0\n- [ ] Stuck detection triggers after 3 failed attempts on same issue | MANUAL | Review logic\n- [ ] Mode selection works: ./loop.sh plan vs ./loop.sh (build) | MANUAL | Test both modes\n- [ ] Iteration counter persists across loop iterations | MANUAL | Check .ralph-attempts file","status":"closed","priority":1,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:43:53.106201374-05:00","created_by":"max","updated_at":"2026-01-26T14:05:06.988238497-05:00","closed_at":"2026-01-26T14:05:06.988238497-05:00","close_reason":"\nVerified:\n- [x] bd ready exit condition (grep verified - PASS)\n- [x] Stuck detection logic (MAX_STUCK_ATTEMPTS=3, check_stuck function - PASS)\n- [x] Mode selection (plan/build parsing - PASS)\n- [x] Iteration counter persistence (ATTEMPT_FILE, increment_attempts - PASS)\n- [x] Script is executable (test -x - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.1","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:43:53.108596475-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.10","title":"Create example acceptance criteria patterns","description":"\n## Context\nExample directory showing different acceptance criteria patterns for common scenarios.\n\n## Approach\n1. examples/acceptance-patterns/test-backed.md\n2. examples/acceptance-patterns/command-output.md\n3. examples/acceptance-patterns/existence-checks.md\n4. examples/acceptance-patterns/llm-as-judge.md\n5. examples/acceptance-patterns/README.md index\n","acceptance_criteria":"- [ ] At least 4 pattern examples exist | `ls examples/acceptance-patterns/*.md 2\u003e/dev/null | wc -l | awk '$1 \u003e= 4'` | 0\n- [ ] README index exists | `test -f examples/acceptance-patterns/README.md` | 0","status":"closed","priority":3,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:56.820142608-05:00","created_by":"max","updated_at":"2026-01-26T14:22:51.706017157-05:00","closed_at":"2026-01-26T14:22:51.706017157-05:00","close_reason":"\nVerified:\n- [x] At least 4 pattern files (found 5 - PASS)\n- [x] README index exists (test -f - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.10","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:56.821526383-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.10","depends_on_id":"htrwb-1u2.4","type":"blocks","created_at":"2026-01-26T13:45:17.136275562-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.11","title":"Create JTBD to Epic conversion example","description":"\n## Context\nExample showing how to convert a Job-to-be-Done into a beads epic with child issues.\n\n## Approach\n1. Example JTBD: 'Help designers create mood boards'\n2. Break into topics of concern\n3. Create epic\n4. Create child tasks with dependencies\n5. Show beads commands used\n","acceptance_criteria":"- [ ] Example directory exists | `test -d examples/jtbd-to-epic` | 0\n- [ ] Shows bd commands | `grep -q 'bd create' examples/jtbd-to-epic/README.md` | 0\n- [ ] Shows dependency setup | `grep -q 'bd dep' examples/jtbd-to-epic/README.md` | 0","status":"closed","priority":3,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:57.075445536-05:00","created_by":"max","updated_at":"2026-01-26T14:24:18.105014615-05:00","closed_at":"2026-01-26T14:24:18.105014615-05:00","close_reason":"\nVerified:\n- [x] Directory exists (test -d - PASS)\n- [x] Shows bd create (grep verified - PASS)\n- [x] Shows bd dep (grep verified - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.11","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:57.077555068-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.12","title":"End-to-end workflow test","description":"\n## Context\nTest the full workflow end-to-end to verify exit conditions work correctly.\n\n## Approach\n1. Initialize beads in test directory\n2. Create simple epic with 2-3 tasks\n3. Run loop.sh in plan mode\n4. Run loop.sh in build mode (limited iterations)\n5. Verify loop exits when bd ready is empty\n6. Verify stuck detection triggers correctly\n","acceptance_criteria":"- [ ] Test script exists | `test -f tests/e2e-workflow.sh` | 0\n- [ ] Script is executable | `test -x tests/e2e-workflow.sh` | 0\n- [ ] Script tests empty queue exit | `grep -q 'bd ready' tests/e2e-workflow.sh` | 0\n- [ ] Script tests stuck detection | `grep -qi 'stuck\\|attempt' tests/e2e-workflow.sh` | 0","status":"closed","priority":1,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:57.318683433-05:00","created_by":"max","updated_at":"2026-01-26T14:17:53.376731041-05:00","closed_at":"2026-01-26T14:17:53.376731041-05:00","close_reason":"\nVerified:\n- [x] Test script exists (test -f - PASS)\n- [x] Script is executable (test -x - PASS)\n- [x] Tests bd ready (grep verified - PASS)\n- [x] Tests stuck detection (grep verified - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.12","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:57.325054993-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.12","depends_on_id":"htrwb-1u2.1","type":"blocks","created_at":"2026-01-26T13:45:16.984851349-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.12","depends_on_id":"htrwb-1u2.2","type":"blocks","created_at":"2026-01-26T13:45:17.0345412-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.12","depends_on_id":"htrwb-1u2.3","type":"blocks","created_at":"2026-01-26T13:45:17.08296155-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.2","title":"Create PROMPT_plan.md with beads integration","description":"\n## Context\nPlanning mode prompt that creates beads issues instead of updating IMPLEMENTATION_PLAN.md.\n\n## References\n- Original: https://github.com/ClaytonFarr/ralph-playbook/blob/main/files/PROMPT_plan.md\n- Draft: docs/ralph-beads-plan.md (Phase 1.2)\n\n## Approach\n1. Replace 'study IMPLEMENTATION_PLAN.md' with 'bd ready' and 'bd list --status open'\n2. Add triage logic for stuck and blocked issues\n3. Add gap analysis that creates beads issues\n4. Include test requirement derivation in issue creation\n5. Enforce acceptance criteria format with verification commands\n6. Add subagent guidance for parallel spec analysis\n","acceptance_criteria":"- [ ] Prompt instructs to create beads issues with --acceptance flag | `grep -q 'acceptance' files/PROMPT_plan.md` | 0\n- [ ] Prompt includes triage phase for stuck issues | `grep -q 'stuck\\|blocked' files/PROMPT_plan.md` | 0\n- [ ] Prompt references bd commands correctly | `grep -q 'bd ready' files/PROMPT_plan.md` | 0\n- [ ] Test requirement derivation included | `grep -qi 'test.*requirement\\|derive.*test' files/PROMPT_plan.md` | 0","status":"closed","priority":1,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:13.652916059-05:00","created_by":"max","updated_at":"2026-01-26T14:08:07.887176092-05:00","closed_at":"2026-01-26T14:08:07.887176092-05:00","close_reason":"\nVerified:\n- [x] --acceptance flag mentioned (grep verified - PASS)\n- [x] Triage for stuck/blocked issues (grep verified - PASS)\n- [x] bd ready referenced (grep verified - PASS)\n- [x] Test requirement derivation (grep verified - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.2","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:13.654884411-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.2","depends_on_id":"htrwb-1u2.4","type":"blocks","created_at":"2026-01-26T13:45:16.415493679-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.3","title":"Create PROMPT_build.md with test-first and verification","description":"\n## Context\nBuilding mode prompt that implements from beads queue with test scaffolding first.\n\n## References\n- Original: https://github.com/ClaytonFarr/ralph-playbook/blob/main/files/PROMPT_build.md\n- Draft: docs/ralph-beads-plan.md (Phase 1.3)\n\n## Approach\n1. Step 0: Orient with bd ready, bd show\n2. Step 1: Claim work with bd update --status in_progress\n3. Step 1.5 (NEW): Create test scaffolding before implementation\n4. Step 2: Implement with subagents\n5. Step 3: Validate against acceptance criteria (run verification commands)\n6. Step 4: Handle discovered work (can add deps, NOT remove)\n7. Step 5: Close with verification evidence\n8. Add guardrails for separation of powers\n","acceptance_criteria":"- [ ] Test scaffolding step exists before implementation | `grep -qi 'test.*scaffold\\|scaffold.*test' files/PROMPT_build.md` | 0\n- [ ] Verification commands must be run before close | `grep -q 'verify.*criteria\\|acceptance.*criteria' files/PROMPT_build.md` | 0\n- [ ] Separation of powers enforced (cannot remove deps) | `grep -q 'CANNOT.*remove.*depend\\|NOT.*remove' files/PROMPT_build.md` | 0\n- [ ] Close requires evidence of verification | `grep -q 'close.*reason\\|--reason' files/PROMPT_build.md` | 0","status":"closed","priority":1,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:13.899144233-05:00","created_by":"max","updated_at":"2026-01-26T14:10:25.975255928-05:00","closed_at":"2026-01-26T14:10:25.975255928-05:00","close_reason":"\nVerified:\n- [x] Test scaffolding step exists (Phase 1.5 - PASS)\n- [x] Verify criteria before close (Phase 3, Phase 5 - PASS)\n- [x] Cannot remove dependencies (Phase 4 You CANNOT - PASS)\n- [x] Close with --reason (Phase 5 - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.3","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:13.902434435-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.3","depends_on_id":"htrwb-1u2.4","type":"blocks","created_at":"2026-01-26T13:45:16.488319407-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.4","title":"Write ACCEPTANCE_CRITERIA.md standards document","description":"\n## Context\nDocument that defines the format and patterns for writing verifiable acceptance criteria.\n\n## References\n- Draft: docs/ralph-beads-plan.md (Phase 2.1)\n\n## Approach\n1. Define standard format: description | command | expected_exit_code\n2. Document patterns: test-backed, command output, existence checks, LLM-as-judge\n3. Document anti-patterns with alternatives\n4. Explain verification in build mode\n5. Include framework-agnostic examples\n","acceptance_criteria":"- [ ] Standard format documented | `grep -q 'verification.*command\\|command.*exit' docs/ACCEPTANCE_CRITERIA.md` | 0\n- [ ] At least 4 patterns documented | `grep -c 'Pattern [0-9]' docs/ACCEPTANCE_CRITERIA.md | awk '$1 \u003e= 4'` | 0\n- [ ] Anti-patterns section exists | `grep -qi 'anti-pattern\\|never use' docs/ACCEPTANCE_CRITERIA.md` | 0\n- [ ] LLM-as-judge pattern included | `grep -qi 'llm.*judge\\|subjective' docs/ACCEPTANCE_CRITERIA.md` | 0","status":"closed","priority":2,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:14.163068646-05:00","created_by":"max","updated_at":"2026-01-26T14:01:20.601178998-05:00","closed_at":"2026-01-26T14:01:20.601178998-05:00","close_reason":"\nVerified:\n- [x] Standard format documented (grep verified - PASS)\n- [x] At least 4 patterns (found 5 patterns - PASS)\n- [x] Anti-patterns section exists (grep verified - PASS)\n- [x] LLM-as-judge pattern included (grep verified - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.4","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:14.166122591-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.5","title":"Write LOOP_CONTROL.md explaining exit mechanisms","description":"\n## Context\nDocumentation explaining how the Ralph loop terminates and prevents infinite iterations.\n\n## References\n- Draft: docs/ralph-beads-plan.md (Phase 3.1)\n\n## Approach\n1. Document three exit conditions: empty queue, max iterations, AC satisfaction\n2. Explain stuck detection mechanism\n3. Document separation of powers preventing gaming\n4. Include iteration counter explanation\n5. Provide troubleshooting for runaway loops\n","acceptance_criteria":"- [ ] Three exit conditions documented | `grep -c 'Exit Condition' docs/LOOP_CONTROL.md | awk '$1 \u003e= 3'` | 0\n- [ ] Stuck detection explained | `grep -qi 'stuck.*detect\\|iteration.*count' docs/LOOP_CONTROL.md` | 0\n- [ ] Separation of powers mentioned | `grep -qi 'separation\\|powers\\|build.*cannot' docs/LOOP_CONTROL.md` | 0","status":"closed","priority":2,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:38.153867949-05:00","created_by":"max","updated_at":"2026-01-26T14:11:36.530369055-05:00","closed_at":"2026-01-26T14:11:36.530369055-05:00","close_reason":"\nVerified:\n- [x] Three exit conditions documented (found 3 - PASS)\n- [x] Stuck detection explained (grep verified - PASS)\n- [x] Separation of powers mentioned (grep verified - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.5","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:38.155186107-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.5","depends_on_id":"htrwb-1u2.1","type":"blocks","created_at":"2026-01-26T13:45:16.557467302-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.6","title":"Create AGENTS.md template for target projects","description":"\n## Context\nTemplate AGENTS.md that projects using ralph-beads should copy and customize.\n\n## References\n- Draft: docs/ralph-beads-plan.md (Phase 4)\n- Original: https://github.com/ClaytonFarr/ralph-playbook/blob/main/files/AGENTS.md\n\n## Approach\n1. Include beads workflow overview\n2. Document session start/end procedures\n3. Include placeholder sections for project-specific commands\n4. Keep brief (~60 lines) per original guidance\n5. Include build mode restrictions\n","acceptance_criteria":"- [ ] Beads workflow documented | `grep -q 'bd ready\\|bd show\\|bd close' files/AGENTS.md` | 0\n- [ ] Build mode restrictions listed | `grep -qi 'cannot\\|forbidden\\|restriction' files/AGENTS.md` | 0\n- [ ] Project-specific placeholders present | `grep -q '\\[project' files/AGENTS.md` | 0\n- [ ] Under 100 lines | `wc -l \u003c files/AGENTS.md | awk '$1 \u003c 100'` | 0","status":"closed","priority":2,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:38.423383863-05:00","created_by":"max","updated_at":"2026-01-26T14:14:13.271021667-05:00","closed_at":"2026-01-26T14:14:13.271021667-05:00","close_reason":"\nVerified:\n- [x] Beads workflow documented (bd ready/show/close - PASS)\n- [x] Build mode restrictions (CANNOT mentioned - PASS)\n- [x] Project placeholders (customize/your command - PASS)\n- [x] Under 100 lines (84 lines - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.6","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:38.425797967-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.6","depends_on_id":"htrwb-1u2.2","type":"blocks","created_at":"2026-01-26T13:45:16.615719965-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.6","depends_on_id":"htrwb-1u2.3","type":"blocks","created_at":"2026-01-26T13:45:16.668675573-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.7","title":"Write QUICKSTART.md 5-minute setup guide","description":"\n## Context\nA concise guide to get users up and running in 5 minutes.\n\n## Approach\n1. Prerequisites (beads installed, project setup)\n2. Copy files step\n3. Initialize beads\n4. First planning loop\n5. First build loop\n6. Verify exit conditions work\n","acceptance_criteria":"- [ ] Prerequisites section exists | `grep -qi 'prereq\\|require' QUICKSTART.md` | 0\n- [ ] Step-by-step commands provided | `grep -c '^\\`\\`\\`' QUICKSTART.md | awk '$1 \u003e= 3'` | 0\n- [ ] Both plan and build modes covered | `grep -q 'plan' QUICKSTART.md \u0026\u0026 grep -q 'build' QUICKSTART.md` | 0","status":"closed","priority":2,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:42.141860877-05:00","created_by":"max","updated_at":"2026-01-26T14:15:32.152310227-05:00","closed_at":"2026-01-26T14:15:32.152310227-05:00","close_reason":"\nVerified:\n- [x] Prerequisites section (grep verified - PASS)\n- [x] Step-by-step commands (30 code block markers - PASS)\n- [x] Both plan and build modes covered (grep verified - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.7","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:42.144182803-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.7","depends_on_id":"htrwb-1u2.1","type":"blocks","created_at":"2026-01-26T13:45:16.742419406-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.7","depends_on_id":"htrwb-1u2.2","type":"blocks","created_at":"2026-01-26T13:45:16.802296971-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.7","depends_on_id":"htrwb-1u2.3","type":"blocks","created_at":"2026-01-26T13:45:16.87776565-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.8","title":"Write README.md with philosophy and overview","description":"\n## Context\nMain project README explaining the why and what of ralph-beads.\n\n## Approach\n1. Hook: What problem does this solve?\n2. Core transformation table (Ralph → Beads)\n3. Key innovations: verifiable exit conditions, test-first\n4. Quick example workflow\n5. Link to QUICKSTART.md and other docs\n6. Comparison table with original Ralph\n","acceptance_criteria":"- [ ] Problem statement exists | `grep -qi 'problem\\|infinite loop\\|exit condition' README.md` | 0\n- [ ] Transformation table present | `grep -q '|.*Ralph.*|.*Beads' README.md` | 0\n- [ ] Links to other docs | `grep -q 'QUICKSTART\\|CLAUDE.md' README.md` | 0","status":"closed","priority":2,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:42.453701856-05:00","created_by":"max","updated_at":"2026-01-26T14:16:41.96036715-05:00","closed_at":"2026-01-26T14:16:41.96036715-05:00","close_reason":"\nVerified:\n- [x] Problem statement (infinite loop mentioned - PASS)\n- [x] Transformation table (Ralph/Beads comparison - PASS)\n- [x] Links to docs (QUICKSTART, CLAUDE.md - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.8","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:42.455200007-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.8","depends_on_id":"htrwb-1u2.7","type":"blocks","created_at":"2026-01-26T13:45:16.936846116-05:00","created_by":"max"}]}
{"id":"htrwb-1u2.9","title":"Write MIGRATION.md for existing Ralph projects","description":"\n## Context\nGuide for converting existing ralph-playbook projects to ralph-beads.\n\n## References\n- Draft: docs/ralph-beads-plan.md (Phase 5)\n\n## Approach\n1. Document IMPLEMENTATION_PLAN.md → beads conversion\n2. Document specs/* → epics conversion\n3. Provide automation script for bulk conversion\n4. Include gotchas and edge cases\n","acceptance_criteria":"- [ ] IMPLEMENTATION_PLAN conversion documented | `grep -qi 'implementation.*plan\\|plan.*md' docs/MIGRATION.md` | 0\n- [ ] Automation script included | `grep -q 'migrate\\|script' docs/MIGRATION.md` | 0\n- [ ] Example conversions shown | `grep -c 'bd create' docs/MIGRATION.md | awk '$1 \u003e= 2'` | 0","status":"closed","priority":3,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T13:44:42.687666032-05:00","created_by":"max","updated_at":"2026-01-26T14:18:53.939934425-05:00","closed_at":"2026-01-26T14:18:53.939934425-05:00","close_reason":"\nVerified:\n- [x] IMPLEMENTATION_PLAN conversion (grep verified - PASS)\n- [x] Automation script included (migrate-plan.sh - PASS)\n- [x] Example conversions (11 bd create commands - PASS)\n","dependencies":[{"issue_id":"htrwb-1u2.9","depends_on_id":"htrwb-1u2","type":"parent-child","created_at":"2026-01-26T13:44:42.689713541-05:00","created_by":"max"},{"issue_id":"htrwb-1u2.9","depends_on_id":"htrwb-1u2.8","type":"blocks","created_at":"2026-01-26T13:45:17.189727636-05:00","created_by":"max"}]}
{"id":"htrwb-9fn","title":"Move referenced docs to files/ directory","description":"\n## Context\nPROMPT_plan.md references docs/ACCEPTANCE_CRITERIA.md, but if users only copy files/*,\nthat reference breaks. Move referenced docs into files/ so they're included.\n\n## Changes\n1. Move docs/ACCEPTANCE_CRITERIA.md to files/docs/ACCEPTANCE_CRITERIA.md\n2. Update PROMPT_plan.md reference\n3. Keep copies in project root docs/ for project documentation\n","acceptance_criteria":"\n- [ ] files/docs/ACCEPTANCE_CRITERIA.md exists | `test -f files/docs/ACCEPTANCE_CRITERIA.md` | exit 0\n- [ ] PROMPT_plan.md references files/docs/ path | `grep -q 'files/docs/\\|docs/ACCEPTANCE' files/PROMPT_plan.md` | exit 0\n","status":"closed","priority":1,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T14:39:06.702842463-05:00","created_by":"max","updated_at":"2026-01-26T14:39:48.616978707-05:00","closed_at":"2026-01-26T14:39:48.616978707-05:00","close_reason":"\nVerified:\n- [x] files/docs/ACCEPTANCE_CRITERIA.md exists (test -f - PASS)\n- [x] PROMPT_plan references docs/ path (grep verified - PASS)\n\nNote: cp -r files/* will copy the docs/ subdirectory to target projects.\n"}
{"id":"htrwb-9s2","title":"Fix double }} in loop_meta JSON logging","description":"## Context\nThe loop.sh script emits loop_meta events to the session log via ralph-state.sh:log_event(), but they have malformed JSON with extra closing braces.\n\n## Current behavior\n```json\n{\"type\":\"loop_meta\",\"event\":\"iteration_start\",...}}}\n```\nNote: THREE closing braces instead of two.\n\n## Expected behavior  \n```json\n{\"type\":\"loop_meta\",\"event\":\"iteration_start\",...}}\n```\n\n## Impact\n- JSON parsers fail on these lines\n- Analysis scripts need workarounds (strip trailing braces)\n\n## Location\n- files/ralph-state.sh:127 - log_event() printf call\n- files/loop.sh:243,267 - callers\n\n## Investigation notes\nThe printf template in ralph-state.sh looks correct. The extra brace may be coming from:\n1. Shell variable expansion issue\n2. Something in the remote sandbox environment  \n3. Claude Code stream-json output mixing with our log","acceptance_criteria":"- loop_meta events are valid JSON (single closing brace)\n- `grep loop_meta log.jsonl | jq .` succeeds without errors","status":"in_progress","priority":3,"issue_type":"bug","owner":"max@ipnts.ai","created_at":"2026-01-28T22:53:51.875572486-05:00","created_by":"max","updated_at":"2026-01-29T14:15:15.656865991-05:00"}
{"id":"htrwb-atd","title":"Design: PREFLIGHT mode for environment verification","description":"\n## Problem\nld8.1 agent found missing tools mid-task, bypassed verification entirely.\n\n## Proposal\nAdd environment verification (PREFLIGHT) at an appropriate point in the workflow. Options:\n- As part of PLAN mode (before creating implementation issues)\n- Between PLAN and BUILD (after issues defined, before work starts)\n- As BUILD mode's first phase (just-in-time verification)\n\nExact placement TBD based on sandbox architecture design.\n\n## PREFLIGHT Dynamic Analysis Approach\nInstead of static requirements files, PREFLIGHT should:\n\n1. **Analyze scope** - Read issues from \\`bd ready\\` or specified scope\n2. **Infer tooling** - From acceptance criteria and file types:\n   - \\`.rs\\` files or \\`cargo test\\` in AC → need cargo/rustc\n   - \\`.py\\` files or \\`pytest\\` in AC → need python/pytest\n   - \\`npm test\\` in AC → need node/npm\n3. **Check environment** - Verify inferred tools exist and work\n4. **Fill gaps or block**:\n   - In sandbox: Attempt installation (uv pip install, rustup, etc.)\n   - Locally: Create blocking issue and STOP\n\n## Environment Detection\nDetect sandbox vs local via environment variables (to be defined in htrwb-hnk).\n\n## Blocked By\n- htrwb-hnk: Design sandbox-aware architecture first\n\n## Reference\n- transcribe-bot/docs/designs/sandbox-preflight-ux.md\n","notes":"## Session Analysis Findings (2026-01-29)\n\nSpecific tool gaps encountered that PREFLIGHT should detect:\n\n1. **protoc** (Protocol Buffers compiler)\n   - Trigger: `.proto` files or `prost` in Cargo.toml\n   - Detection: `which protoc`\n   - Install: `dnf install protobuf-compiler` (not apt-get on sandbox)\n\n2. **Python test dependencies**\n   - Trigger: `pytest` in AC or `tests/` directory with `.py` files\n   - Detection: `python -c 'import pytest'`\n   - Also check for project-specific deps (SQLAlchemy, etc.)\n\n3. **Rust toolchain**\n   - Trigger: `Cargo.toml` present\n   - Detection: `cargo --version`, `rustc --version`\n\nAgent wasted 4 tool calls on environment setup. PREFLIGHT should catch these before work begins.","status":"open","priority":2,"issue_type":"feature","owner":"max@ipnts.ai","created_at":"2026-01-28T10:53:14.093822619-05:00","created_by":"max","updated_at":"2026-01-28T23:07:59.214203917-05:00","dependencies":[{"issue_id":"htrwb-atd","depends_on_id":"htrwb-hnk","type":"blocks","created_at":"2026-01-28T11:49:58.539254248-05:00","created_by":"max"}]}
{"id":"htrwb-ca7","title":"Strengthen verification standards in BUILD prompt","description":"## Context\nSession analysis (2026-01-29) found agent closing task with 'syntax valid' when AC specified 'tests pass'. This circumvents the acceptance criteria integrity.\n\n## Problem\nIn task transcribe-bot-gyw, the agent couldn't run pytest (missing SQLAlchemy) and closed with:\n\u003e 'The async iterator fix is correct - verified by syntax check'\n\nBut the AC likely required tests to pass, not just syntax validity.\n\n## Solution\nStrengthen PROMPT_build.md guardrails:\n\n1. Add explicit prohibition: 'syntax check/valid' is NEVER acceptable for 'tests pass' AC\n2. If tests cannot run due to missing deps:\n   - In sandbox: Attempt to install deps (pip install, etc.)\n   - If still blocked: Create blocking issue, do NOT close original task\n3. Add examples of invalid substitutions to prevent\n\n## References\n- files/PROMPT_build.md:94-119 (Definition of Done, AC Integrity sections)\n- analysis/logs/ralph-session-2026-01-29.log (events #155-168)","acceptance_criteria":"- PROMPT_build.md explicitly prohibits syntax-only verification for test ACs\n- Examples of invalid verification shortcuts documented\n- Guidance added for handling missing test dependencies","status":"in_progress","priority":2,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-28T23:07:39.667370626-05:00","created_by":"max","updated_at":"2026-01-29T14:15:15.621130289-05:00"}
{"id":"htrwb-d0u","title":"Make specs optional - support beads-first workflow","description":"\n## Context\nUsers may start with beads epics directly (created in Claude Code) rather than specs/*.md files.\nThe prompts should work in both cases.\n\n## Approach\n1. Update PROMPT_plan.md to check for specs, fall back to epics\n2. Update PROMPT_build.md similarly\n3. Update QUICKSTART.md to document both workflows\n4. Update README.md to mention beads-first workflow\n\n## References\n- files/PROMPT_plan.md\n- files/PROMPT_build.md\n","acceptance_criteria":"\n- [ ] PROMPT_plan.md checks for specs existence | `grep -q 'specs.*exist\\|if.*specs' files/PROMPT_plan.md` | exit 0\n- [ ] PROMPT_plan.md references epics as fallback | `grep -qi 'epic.*source\\|fallback.*epic' files/PROMPT_plan.md` | exit 0\n- [ ] PROMPT_build.md updated similarly | `grep -qi 'specs.*optional\\|epic' files/PROMPT_build.md` | exit 0\n","status":"closed","priority":1,"issue_type":"feature","owner":"max@ipnts.ai","created_at":"2026-01-26T14:32:10.718445464-05:00","created_by":"max","updated_at":"2026-01-26T14:33:15.258534496-05:00","closed_at":"2026-01-26T14:33:15.258534496-05:00","close_reason":"\nVerified:\n- [x] PROMPT_plan checks specs existence (grep verified - PASS)\n- [x] PROMPT_plan references epics as fallback (grep verified - PASS)\n- [x] PROMPT_build updated similarly (grep verified - PASS)\n"}
{"id":"htrwb-e3e","title":"Epic: Prompt Hardening for Session Reliability","description":"\n## Overview\nImprove BUILD and PLAN mode prompts to prevent the failure patterns observed in ld8.1:\n- Acceptance criteria manipulation ('tests pass' → 'pending CI')\n- Definition of done erosion (syntax check ≠ verification)\n- Batch-and-pray development (5 files without running any)\n- TodoWrite usage despite prohibition\n- No progress tracking with beads\n\n## Success Criteria\n- Prompts explicitly forbid CI deferral, AC reinterpretation, and batch development\n- TodoWrite prohibition is explicit with positive beads guidance\n- Agents use bd update --notes for progress tracking\n- All prompt changes are in PROMPT_build.md and PROMPT_plan.md\n\n## Reference\n- Session review: transcribe-bot/docs/session-reviews/ld8.1-review.md\n- Sandbox UX design: transcribe-bot/docs/designs/sandbox-preflight-ux.md\n","status":"closed","priority":1,"issue_type":"epic","owner":"max@ipnts.ai","created_at":"2026-01-28T11:41:39.151472588-05:00","created_by":"max","updated_at":"2026-01-28T12:09:20.784791383-05:00","closed_at":"2026-01-28T12:09:20.784791383-05:00","close_reason":"\nAll 4 child tasks completed:\n- htrwb-e3e.1: TodoWrite prohibition + beads reinforcement\n- htrwb-mry: Definition of done - no CI deferral  \n- htrwb-efp: Prevent acceptance criteria reinterpretation\n- htrwb-q5l: TDD incrementalism\n\nChanges made to:\n- files/PROMPT_build.md: Tool Restrictions, Definition of Done, AC Integrity, Incremental Development Rule\n- files/PROMPT_plan.md: Tool Restrictions, AC Standards in Guardrails\n"}
{"id":"htrwb-e3e.1","title":"Prompt: Prohibit TodoWrite with positive beads reinforcement","description":"\n## Context\nld8.1 agent used TodoWrite 7 times despite CLAUDE.md prohibition. The agent needs explicit in-prompt guidance.\n\n## References\n- files/PROMPT_build.md\n- files/PROMPT_plan.md\n- Session review showing 7 TodoWrite calls between 01:46:14 and 02:51:59\n\n## Approach\nAdd explicit prohibition section to both prompts:\n\n```markdown\n## Tool Restrictions\n\nDO NOT use TodoWrite, TaskCreate, or markdown files for task tracking.\n\nFor ALL task/progress tracking, use beads:\n- \\`bd update \u003cid\u003e --status in_progress\\` - Claim work\n- \\`bd comments add \u003cid\u003e 'Started work on X'\\` - Log progress (append-only)\n- \\`bd comments add \u003cid\u003e 'Completed Y, moving to Z'\\` - Progress checkpoints\n- \\`bd create --title='...' --type=task\\` - Create discovered work\n- \\`bd close \u003cid\u003e\\` - Mark complete\n\nUse \\`bd comments add\\` for progress logging (append-only, creates chronological record).\nUse \\`bd update --notes\\` for persistent context that should remain visible.\n\nIf you find yourself reaching for TodoWrite, STOP and use the equivalent bd command.\n```\n","acceptance_criteria":"- PROMPT_build.md contains explicit TodoWrite prohibition\n- PROMPT_build.md contains positive beads commands for progress tracking\n- PROMPT_plan.md contains equivalent guidance\n- Prohibition appears early in the prompt (not buried at bottom)","status":"closed","priority":1,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-28T11:45:50.856075508-05:00","created_by":"max","updated_at":"2026-01-28T12:08:56.785388339-05:00","closed_at":"2026-01-28T12:08:56.785388339-05:00","close_reason":"\nVerified:\n- [x] PROMPT_build.md contains explicit TodoWrite prohibition (lines 23-37)\n- [x] PROMPT_build.md contains positive beads commands for progress tracking (bd comments add, bd update)\n- [x] PROMPT_plan.md contains equivalent guidance (lines 26-38)\n- [x] Prohibition appears early in both prompts (after Phase 0, before Phase 1)\n","dependencies":[{"issue_id":"htrwb-e3e.1","depends_on_id":"htrwb-e3e","type":"parent-child","created_at":"2026-01-28T11:45:50.858487986-05:00","created_by":"max"}],"comments":[{"id":1,"issue_id":"htrwb-e3e.1","author":"max","text":"Starting implementation - adding Tool Restrictions section to both prompts","created_at":"2026-01-28T16:53:19Z"}]}
{"id":"htrwb-efp","title":"Prompt: Prevent acceptance criteria reinterpretation","description":"Add guard against dynamic reinterpretation of acceptance criteria.\n\n## Problem\nld8.1 agent changed 'tests pass' to 'tests pending CI' and marked task complete.\n\n## Proposed Addition\n```markdown\n## Acceptance Criteria Integrity\n\nYou MUST NOT reinterpret acceptance criteria during implementation:\n- 'tests pass' means tests PASS, not 'tests exist' or 'tests pending CI'\n- 'builds successfully' means BUILD SUCCEEDS, not 'syntax valid'\n\nIf you cannot verify a criterion as written:\n1. The task is BLOCKED, not complete\n2. Create a blocking issue documenting why verification failed\n3. Move to next available task\n\nNEVER lower the bar to close a task.\n```","status":"closed","priority":1,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-28T10:53:40.418730194-05:00","created_by":"max","updated_at":"2026-01-28T12:09:01.058126746-05:00","closed_at":"2026-01-28T12:09:01.058126746-05:00","close_reason":"\nVerified:\n- [x] PROMPT_build.md contains 'Acceptance Criteria Integrity' section (lines 107-120)\n- [x] Explicit examples: 'tests pass means tests PASS, not tests exist or pending CI'\n- [x] Clear guidance: if cannot verify, task is BLOCKED not complete\n- [x] PROMPT_plan.md Guardrails updated with AC Standards (lines 175-189)\n- [x] PLAN prompt emphasizes criteria are a contract that BUILD cannot modify\n","dependencies":[{"issue_id":"htrwb-efp","depends_on_id":"htrwb-e3e","type":"parent-child","created_at":"2026-01-28T11:46:21.392204052-05:00","created_by":"max"}],"comments":[{"id":3,"issue_id":"htrwb-efp","author":"max","text":"Adding AC Integrity guardrail to BUILD prompt","created_at":"2026-01-28T17:05:15Z"}]}
{"id":"htrwb-g1y","title":"Update docs for beads-first workflow","description":"\n## Context\nREADME and QUICKSTART still only document the specs-first workflow.\nNeed to document the beads-first alternative.\n\n## Files\n- README.md\n- QUICKSTART.md\n","acceptance_criteria":"\n- [ ] README mentions both workflows | `grep -qi 'beads-first\\|two workflow\\|without specs' README.md` | exit 0\n- [ ] QUICKSTART has beads-first section | `grep -qi 'beads-first\\|without specs\\|skip.*spec' QUICKSTART.md` | exit 0\n","status":"closed","priority":1,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T14:33:55.641131567-05:00","created_by":"max","updated_at":"2026-01-26T14:34:55.929964464-05:00","closed_at":"2026-01-26T14:34:55.929964464-05:00","close_reason":"\nVerified:\n- [x] README mentions both workflows (beads-first section added - PASS)\n- [x] QUICKSTART has beads-first section (Skip Specs section added - PASS)\n"}
{"id":"htrwb-hnk","title":"Design: Sandbox-Aware Execution Architecture","description":"\n## Overview\nDesign how htrwb can leverage sandboxes generically without coupling to any specific sandbox solution. Enable loop.sh to run locally while agent work happens on remote/containerized sandboxes.\n\n## Key Design Questions\n\n### 1. Environment Contract\nWhat should htrwb expect/document that sandboxes may provide?\n- SSH or SSM access patterns\n- Environment variables (e.g., RALPH_SANDBOX=1, RALPH_REMOTE_HOST)\n- Tool availability guarantees (or lack thereof)\n\n### 2. Local/Remote Execution Model\n- loop.sh runs locally (no need to keep SSH/SSM session open)\n- \\`claude -p ...\\` invocations happen on remote\n- Configuration options: fully local, fully remote, hybrid\n\n### 3. PREFLIGHT Dynamic Analysis\nInstead of static requirements files:\n- Analyze issues in scope (\\`bd ready\\`)\n- Infer required tooling from acceptance criteria and file types\n- Check environment for those tools\n- Fill gaps (in sandbox) or create blocking issues (locally)\n\n### 4. Communication Patterns\n- How does local loop.sh invoke remote claude?\n- How are results/artifacts transferred?\n- How is beads state synchronized?\n\n## Motivation\nld8.1 ran in a sandbox but encountered missing tools mid-session. The agent bypassed verification ('CI will run it') rather than fixing the environment. A sandbox-aware architecture would:\n1. Enable PREFLIGHT to install missing tools in sandboxes\n2. Keep the orchestration loop local for reliability\n3. Isolate risky operations to sandboxes\n\n## Related Issues\n- htrwb-atd: PREFLIGHT mode (needs update based on this design)\n\n## Next Steps\nDiscuss and refine this design before creating implementation epic.\n","acceptance_criteria":"- Design document written with clear architecture decisions\n- Environment contract documented\n- Local/remote execution model specified\n- PREFLIGHT dynamic analysis approach defined","notes":"## Session Analysis Findings (2026-01-29)\n\nEnvironment Contract should document sandbox-specific details:\n\n1. **Package manager**: `dnf` (NOT `apt-get`)\n2. **Available by default**: git, python, node, rust, docker\n3. **NOT available**: protobuf-compiler (protoc), project-specific Python deps\n4. **Install patterns**: \n   - System packages: `sudo dnf install -y \u003cpkg\u003e`\n   - Python: `pip install` or `uv pip install`\n   - Rust: `cargo install` or `rustup component add`\n\nThe agent tried `apt-get` first (failed), then `dnf` (worked for some things).\n\nAlso note: git workflow on sandbox has issues with .beads/ sync. Agent had to use `git stash` workaround. This may need sandbox-side fix (auto-sync hooks or similar).","status":"open","priority":2,"issue_type":"feature","owner":"max@ipnts.ai","created_at":"2026-01-28T11:48:33.976054522-05:00","created_by":"max","updated_at":"2026-01-28T23:08:07.37824597-05:00"}
{"id":"htrwb-kt5","title":"Design: Analytics \u0026 Feedback Infrastructure","description":"## Overview\nWork through how htrwb can leverage session data for two related but distinct purposes:\n\n1. **Live Observability** - Better status tracking of running loops\n2. **Systematic Improvement** - Feedback loop for prompt/loop optimization\n\nBoth depend on data capture, but have different consumers and requirements.\n\n## Key Design Questions\n\n### 1. Data Foundation\nWhat data do we capture and how?\n- Current: JSONL session logs (when RALPH_LOG_DIR set)\n- Current: loop_meta.json per iteration\n- Gap: Real-time streaming vs post-hoc analysis\n- Gap: Structured metrics vs raw transcripts\n\n### 2. Live Observability Options\n**Simple (prints to screen)**\n- Progress bars, iteration counts, token usage\n- Issue status changes, test results\n- Could be built into loop.sh directly\n\n**TUI (terminal UI)**\n- ncurses/rich-style dashboard\n- Multiple panes: current task, recent activity, stats\n- Tools: rich (Python), bubbletea (Go), blessed (Node)\n\n**WebUI**\n- Browser-based dashboard\n- Real-time updates via SSE/WebSocket\n- Historical views, charts, drill-down\n- Tools: Langfuse (OSS), custom Flask/FastAPI app\n\n### 3. Feedback Loop Architecture\nHow do we close the loop from 'data gathered' to 'prompts improved'?\n\n**Analysis Pipeline**\n- Pattern detection: What causes loops? What causes skipped verification?\n- Success/failure correlation with prompt sections\n- Token efficiency analysis\n\n**Improvement Mechanisms**\n- Manual: Generate reports, human reviews and updates prompts\n- Semi-auto: LLM analyzes patterns, suggests prompt changes\n- Auto: A/B testing framework, automatic prompt evolution\n\n### 4. Integration Points\n- Where does analysis run? (local scripts, CI, separate service)\n- How are improvements deployed? (PR workflow, direct edit)\n- How do we track improvement effectiveness?\n\n## Existing Work\n- `files/analysis/` - Python scripts for session log analysis\n- `files/analysis/flow_analysis.py` - Tracks mode transitions, iteration patterns\n- `files/analysis/create_issues.py` - Creates beads issues from analysis\n\n## Expected Decomposition\nLikely splits into:\n1. **Data Infrastructure Epic** - Capture, storage, streaming\n2. **Live Observability Epic** - Status tracking, dashboards\n3. **Feedback Loop Epic** - Analysis, improvement, measurement\n\n## Related\n- External tools: Langfuse, OpenLLMetry, Phoenix (Arize) for OSS observability\n- htrwb-hnk: Sandbox architecture (may affect where analysis runs)\n\n## Next Steps\nDiscuss trade-offs, pick initial scope, create implementation epics.","acceptance_criteria":"- Design document with architecture decisions\n- Data requirements documented\n- At least 2 implementation epics created from decomposition\n- Integration approach with existing analysis scripts defined","status":"open","priority":2,"issue_type":"feature","owner":"max@ipnts.ai","created_at":"2026-01-29T13:35:49.993071793-05:00","created_by":"max","updated_at":"2026-01-29T13:35:49.993071793-05:00"}
{"id":"htrwb-mry","title":"Prompt: Strengthen definition of done - no CI deferral","description":"Add explicit guidance that 'runs successfully' means VERIFIED LOCALLY, not 'will run in CI'.\n\n## Problem\nld8.1 agent reinterpreted 'cargo test passes' as 'pending CI - no cargo locally'.\n\n## Proposed Addition\n```markdown\n## Definition of Done\n\nAcceptance criteria with verification commands (e.g., 'tests pass', 'builds successfully') \nMUST be verified locally before marking complete.\n\nIf verification is impossible:\n1. ATTEMPT to fix the environment (install tools, create venv)\n2. If still blocked, create a BLOCKING ISSUE explaining why\n3. DO NOT mark the task complete\n\n'Syntax check' or 'files exist' is NOT verification.\n'CI will run it' is NOT verification.\n```","status":"closed","priority":1,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-28T10:53:36.415219986-05:00","created_by":"max","updated_at":"2026-01-28T12:08:59.146528985-05:00","closed_at":"2026-01-28T12:08:59.146528985-05:00","close_reason":"\nVerified:\n- [x] PROMPT_build.md contains 'Definition of Done' section (lines 92-104)\n- [x] Explicitly states: 'Syntax check is NOT verification', 'CI will run it is NOT verification'\n- [x] Requires attempting env fix before creating blocking issue\n- [x] Explicitly forbids marking task complete without local verification\n","dependencies":[{"issue_id":"htrwb-mry","depends_on_id":"htrwb-e3e","type":"parent-child","created_at":"2026-01-28T11:46:21.200889869-05:00","created_by":"max"}],"comments":[{"id":2,"issue_id":"htrwb-mry","author":"max","text":"Adding Definition of Done section to BUILD prompt","created_at":"2026-01-28T17:05:14Z"}]}
{"id":"htrwb-q5l","title":"Prompt: Add TDD incrementalism to BUILD mode","description":"Add 'write one, run one' rule to BUILD mode prompts.\n\n## Problem\nld8.1 agent wrote 5 test files consecutively without running any (batch-and-pray).\n\n## Proposed Addition\n```markdown\n## Incremental Development Rule\n\nWhen creating multiple files (tests, modules, etc.):\n1. Write ONE file\n2. Run verification (test, compile, lint)\n3. Fix any failures\n4. Commit checkpoint (optional)\n5. Move to next file\n\nNEVER write multiple files without verification between them.\n```","status":"closed","priority":2,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-28T10:53:28.252588388-05:00","created_by":"max","updated_at":"2026-01-28T12:09:03.51477624-05:00","closed_at":"2026-01-28T12:09:03.51477624-05:00","close_reason":"\nVerified:\n- [x] PROMPT_build.md Phase 2 contains 'Incremental Development Rule' (lines 78-90)\n- [x] Clear 5-step workflow: Write ONE file, Run verification, Fix failures, Commit, Move to next\n- [x] Explicit: 'NEVER write multiple files without verification between them'\n- [x] Explains rationale: prevents batch-and-pray, exponentially harder debugging\n","dependencies":[{"issue_id":"htrwb-q5l","depends_on_id":"htrwb-e3e","type":"parent-child","created_at":"2026-01-28T11:46:21.571772138-05:00","created_by":"max"}],"comments":[{"id":4,"issue_id":"htrwb-q5l","author":"max","text":"Adding incrementalism rule to BUILD prompt Phase 2","created_at":"2026-01-28T17:06:11Z"}]}
{"id":"htrwb-qha","title":"Add RALPH_SCOPE support to loop.sh","description":"\n## Overview\nModify loop.sh to use RALPH_SCOPE env var for filtering bd ready results.\n\n## Context\nWhen running scoped loops (e.g., one worktree per epic), the loop should only pick up work from within that scope.\n\n## Implementation\n```bash\n# In loop.sh, replace hardcoded bd ready with:\nif [ -n \"${RALPH_SCOPE:-}\" ]; then\n  READY_CMD=\"bd ready --parent=${RALPH_SCOPE} --json\"\nelse\n  READY_CMD=\"bd ready --json\"\nfi\n\nREADY_TASK=$($READY_CMD | head -1)\n```\n\n## Usage\n```bash\n# Scoped to epic ld8\nRALPH_SCOPE=ld8 ./loop.sh build\n\n# Unscoped (all issues)\n./loop.sh build\n```\n","acceptance_criteria":"- loop.sh checks RALPH_SCOPE env var\n- When set, bd ready uses --parent filter\n- When unset, bd ready returns all issues (backwards compatible)","status":"closed","priority":2,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-26T15:32:51.849296523-05:00","created_by":"max","updated_at":"2026-01-26T15:41:07.536324411-05:00","closed_at":"2026-01-26T15:41:07.536324411-05:00","close_reason":"Implemented RALPH_SCOPE support in loop.sh:\n- Added RALPH_SCOPE env var configuration (line 26)\n- Created get_bd_ready_cmd() helper that conditionally adds --parent filter\n- Updated all bd ready calls to use the scoped helper\n- Added scope display in header output\n- Backwards compatible (empty RALPH_SCOPE uses standard bd ready)"}
{"id":"htrwb-rqe","title":"Reduce orientation overhead in BUILD mode","description":"## Context\nSession analysis found 20% of tool calls (11/55) were orientation commands (bd ready, bd show, bd list). This is higher than needed.\n\n## Observed Patterns\n- Multiple `bd show \u003cid\u003e` calls for same issue\n- Repeated `bd ready` calls between tasks\n- Agent re-fetching context it already has\n\n## Potential Solutions\n\n### Option A: Prompt Guidance\nAdd guidance to PROMPT_build.md:\n- 'Cache issue details mentally - avoid re-fetching same issue'\n- 'After closing a task, immediately check bd ready output for next task'\n\n### Option B: Context Injection\nHave loop.sh inject current issue details directly into prompt, reducing need for bd show calls.\n\n### Option C: Accept as Necessary\nSome overhead may be unavoidable for robust operation. The 20% may be acceptable.\n\n## Recommendation\nStart with Option A (low effort), measure impact in future sessions.\n\n## References\n- analysis/scripts/analyze_efficiency.py\n- analysis/logs/ralph-session-2026-01-29.log","acceptance_criteria":"- Decision documented on which approach to take\n- If Option A: PROMPT_build.md updated with guidance\n- Baseline measurement recorded for comparison","status":"in_progress","priority":3,"issue_type":"task","owner":"max@ipnts.ai","created_at":"2026-01-28T23:07:50.280996701-05:00","created_by":"max","updated_at":"2026-01-29T14:15:15.685517298-05:00"}
